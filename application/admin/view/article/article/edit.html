<!DOCTYPE html>
<html lang="en">
<head>
  {include file="public/header" title="文章修改"  /}

{load href="/static/fileinput/css/bootstrap.min.css" /}
{load href="/static/fileinput/css/bootstrap-fileinput.css" /}
{load href="/static/fileinput/js/bootstrap-fileinput.js" /}
</head>
<body style="padding:15px">
  <div class="layui-card">
          <div class="layui-card-body">
            <form class="layui-form" action="" onsubmit="return false" lay-filter="component-form-element" id="uploadForm" enctype="multipart/form-data">
              <div class="layui-row layui-col-space10 layui-form-item">
                
                <div class="layui-col-lg12">
                  <label class="layui-form-label">标 题：</label>
                  <div class="layui-input-block">
                    <input type="text" name="title" lay-verify="required" value="{$info.title}" placeholder="请输入" autocomplete="off" class="layui-input">
                  </div>
                </div>

                <div class="layui-col-lg12">
                  <label class="layui-form-label">作 者：</label>
                  <div class="layui-input-block">
                    <input type="text" name="author" lay-verify="required" value="{$info.author}" placeholder="请输入" autocomplete="off" class="layui-input">
                  </div>
                </div>

                <div class="layui-form-item">
                <label class="layui-form-label">状 态：</label>
                <div class="layui-input-block">
                  <input type="radio" name="status" {if condition="$info.status eq 1"}checked="checked"{/if}  value="1" title="发布">
                  <div class="layui-unselect layui-form-radio"><i class="layui-anim layui-icon"></i>
                  <div>发布</div>
                  </div>
                  <input type="radio" name="status" {if condition="$info.status eq 0"}checked="checked"{/if} value="0" title="待审核"><div class="layui-unselect layui-form-radio"><i class="layui-anim layui-icon"></i><div>待审核</div></div>
                </div>
                </div>

                <div class="layui-form-item">
                <label class="layui-form-label">推荐：</label>
                <div class="layui-input-block">
                  <input type="radio" name="is_good" {if condition="$info.is_good eq 1"}checked="checked"{/if}  value="1" title="推荐">
                  <div class="layui-unselect layui-form-radio"><i class="layui-anim layui-icon"></i>
                  <div>推荐</div>
                  </div>
                  <input type="radio" name="is_good" {if condition="$info.is_good eq 2"}checked="checked"{/if} value="2" title="不推荐"><div class="layui-unselect layui-form-radio"><i class="layui-anim layui-icon"></i><div>不推荐</div></div>
                </div>
                </div>

                <div class="layui-form-item">
                <label class="layui-form-label">标签：</label>
                <div class="layui-input-block">
                  <input type="radio" name="tag"  {if condition="$info.tag eq 0"}checked="checked"{/if} value="0" title="转载">
                  <div class="layui-unselect layui-form-radio"><i class="layui-anim layui-icon"></i>
                  <div>转载</div>
                  </div>
                  <input type="radio" name="tag" {if condition="$info.tag eq 1"}checked="checked"{/if} value="1" title="原创"><div class="layui-unselect layui-form-radio"><i class="layui-anim layui-icon"></i><div>原创</div></div>
                </div>
                </div>

                <div class="layui-col-lg12">
                  <label class="layui-form-label">封面图片：</label>
                  <div class="layui-input-block">
                    <div class="fileinput fileinput-new" data-provides="fileinput"  id="exampleInputUpload">
                    <div class="fileinput-new thumbnail" style="width: 200px;height: auto;max-height:150px;">
                        <img id='picImg' style="width: 100%;height: auto;max-height: 140px;" src="/uploads/{$info.pic}" alt="" />
                    </div>
                    <div class="fileinput-preview fileinput-exists thumbnail" style="max-width: 200px; max-height: 150px;"></div>
                    <div>
                        <span class="btn btn-primary btn-file">
                            <span class="fileinput-new">选择文件</span>
                            <span class="fileinput-exists">换一张</span>
                            <input type="file" name="file" id="file" accept="image/gif,image/jpeg,image/x-png"/>
                        </span>
                        <a href="javascript:;" class="btn btn-warning fileinput-exists" data-dismiss="fileinput">移除</a>
                    </div>
                    </div>
                  </div>
                </div>

                <div class="layui-col-lg12">
                  <label class="layui-form-label">类 别：</label>
                  <div class="layui-input-block">
                  <select name="categoryid" style="padding-left:100px;" lay-verify="required" id="selected">
                  <option value="">请选择问题</option>
                  {foreach name="list" item="vo"}
                  <option  value="{$vo.id}">{$vo.fullname}</option>
                  {/foreach}
                  </select>
                  </div>
                </div>

                <div class="layui-col-lg12">
                  <label class="layui-form-label">关键字：</label>
                  <div class="layui-input-block">
                    <input  type="text" name="keywords" lay-verify="" value="{$info.keywords}" placeholder="多个已逗号分隔" autocomplete="off" class="layui-input">
                  </div>
                </div>

                <div class="layui-col-lg12">
                  <label class="layui-form-label">简 介：</label>
                  <div class="layui-input-block">
                    <textarea name="synopsis" rows="10" placeholder="请输入" class="layui-textarea">{$info.synopsis}</textarea>
                  </div>
                </div>

                <div class="layui-col-lg12">
                  <label class="layui-form-label">新闻内容：</label>
                  <div class="layui-input-block">
                    <script id="editor" type="text/plain" name="content" style="width:100%">{$info.content}</script>
                  </div>
                </div>

                <input type="hidden" name="id" value="{$info.id}">
                <div class="layui-form-item">
                  <div class="layui-input-block">
                    <button class="layui-btn" lay-submit="" lay-filter="demo1" id="sub">立即提交</button>
                    <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                  </div>
                </div>
                </div>
            </form>
          </div>
        </div>
</body>
 {include file="public/foot" /} 


  {load href="/static/ueditor1_4_3_3-utf8-php/ueditor.config.js" /}
  {load href="/static/ueditor1_4_3_3-utf8-php/ueditor.all.min.js" /}
  <!--建议手动加在语言，避免在ie下有时因为加载语言失败导致编辑器加载失败-->
  <!--这里加载的语言文件会覆盖你在配置项目里添加的语言类型，比如你在配置项目里配置的是英文，这里加载的中文，那最后就是中文-->
  {load href="/static/ueditor1_4_3_3-utf8-php/lang/zh-cn/zh-cn.js" /}


<!-- 注意：如果你直接复制所有代码到本地，上述js路径需要改成你本地的 -->

<!-- 编辑器源码文件 -->

<!-- 实例化编辑器 -->
<script type="text/javascript">
    var ue = UE.getEditor('editor');
    ue.ready(function() {
            ue.setHeight(400);
           //设置编辑器的内容
      });
    $(function(){
  $("input[type=file]").change(function(){$(this).parents(".uploader").find(".filename").val($(this).val());});
  $("input[type=file]").each(function(){
  if($(this).val()==""){$(this).parents(".uploader").find(".filename").val("No file selected...");}
  });
});
</script>

<script>

<!-- 配置文件 -->
   
var condition = new Array();
layui.use(['form','table', 'layedit','laydate'], function(){
  var table = layui.table;
  var form = layui.form;
  $("#selected").find("option[value={$info.categoryid}]").prop("selected",true);
  form.render();
  form.on('submit(demo1)', function(data){  
    var index = parent.layer.getFrameIndex(window.name);
   
    var img_file  = $('#upload').val();

    var dataForm = new FormData($('#uploadForm')[0]);
 
    $.ajax({

      url:"{:url('/article.article/edit')}",
      data:dataForm,
      type: "POST",
      processData : false, 
      // 告诉jQuery不要去设置Content-Type请求头
      contentType : false,
      dataType: "json",
      success:function(data)
      {
        layer.alert(data.msg, {
          skin: data.skin
          ,closeBtn: 0
          ,anim: data.anim //动画类型
          ,icon: data.status
        }
        ,function()
        {
          if(data.status==1)
          {
            parent.heavyLoad(condition);
            parent.layer.close(index);
          }
          else
          {
            layer.closeAll('dialog');
          }
        }
        );
      }
    });
  });


});



</script>
</html> 